#!/usr/bin/env node
/**
 * üéØ ContentBot - –î–ï–ú–û –î–õ–Ø –ö–õ–ò–ï–ù–¢–ê
 * –¢–µ–º–∞: –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –±–∏–∑–Ω–µ—Å–∞ –≤ –†–§ (–§–ó-54, –∫–∞—Å—Å—ã, 1–°, –º–∞—Ä–∫–∏—Ä–æ–≤–∫–∞)
 */

process.chdir('/home/user1/telegram_parser');
require('dotenv').config();

const { MTProtoClient } = require('./dist/mtproto/client');
const axios = require('axios');
const fs = require('fs');

console.log('üéØ ContentBot - –î–ï–ú–û –î–õ–Ø –ö–õ–ò–ï–ù–¢–ê');
console.log('üìã –¢–µ–º–∞: –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –±–∏–∑–Ω–µ—Å–∞ –≤ –†–§');
console.log('='*60);

class BusinessAutomationDemo {
    constructor() {
        this.mt = MTProtoClient.get();
        this.client = this.mt.getClient();
        this.targetChannelName = "–ö–∞–Ω–∞–ª—ã –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ —Å–¥–µ–ª–æ–∫";
        this.LLM_API_KEY = process.env.LLM_API;
    }

    async init() {
        await this.mt.start();
        console.log('‚úÖ Telegram –∫–ª–∏–µ–Ω—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω');
    }

    async generateBusinessContent() {
        try {
            console.log('ü§ñ –ì–ï–ù–ï–†–ê–¶–ò–Ø –ö–û–ù–¢–ï–ù–¢–ê –ü–û –ê–í–¢–û–ú–ê–¢–ò–ó–ê–¶–ò–ò –ë–ò–ó–ù–ï–°–ê...');
            
            const response = await axios.post(
                'https://foundation-models.api.cloud.ru/v1/chat/completions',
                {
                    model: 'openai/gpt-oss-120b',
                    messages: [
                        {
                            role: "system",
                            content: "–¢—ã —ç–∫—Å–ø–µ—Ä—Ç –ø–æ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –±–∏–∑–Ω–µ—Å–∞ –≤ –†–æ—Å—Å–∏–∏. –°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—à—å—Å—è –Ω–∞ –§–ó-54, –∫–∞—Å—Å–æ–≤—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö (–ê–¢–û–õ, –≠–í–û–¢–û–†), 1–°, –º–∞—Ä–∫–∏—Ä–æ–≤–∫–µ —Ç–æ–≤–∞—Ä–æ–≤, –ï–ì–ê–ò–°. –°–æ–∑–¥–∞–≤–∞–π –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç –¥–ª—è –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª–µ–π."
                        },
                        {
                            role: "user",
                            content: `–°–æ–∑–¥–∞–π 3 —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –ø–æ—Å—Ç–∞ –¥–ª—è Telegram –∫–∞–Ω–∞–ª–∞ –æ–± –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –±–∏–∑–Ω–µ—Å–∞ –≤ –†–§.

–¢–ï–ú–´:
- –§–ó-54 –∏ –Ω–æ–≤—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –∫–∞—Å—Å–∞–º
- –ö–∞—Å—Å—ã –ê–¢–û–õ –∏ –≠–í–û–¢–û–† –¥–ª—è –º–∞—Ä–∫–∏—Ä–æ–≤–∫–∏
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è 1–° —Å –∫–∞—Å—Å–æ–≤—ã–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏
- –ú–∞—Ä–∫–∏—Ä–æ–≤–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤ –∏ –ï–ì–ê–ò–° 3.0
- –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–æ–±–æ—Ä–æ—Ç–∞

–¢–†–ï–ë–û–í–ê–ù–ò–Ø:
- 3 –ø–æ—Å—Ç–∞ –ø–æ 500-700 —Å–∏–º–≤–æ–ª–æ–≤
- –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Å–æ–≤–µ—Ç—ã –¥–ª—è –±–∏–∑–Ω–µ—Å–∞
- –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ü–∏—Ñ—Ä—ã –∏ –¥–∞—Ç—ã
- –ü—Ä–∏–∑—ã–≤—ã –∫ –¥–µ–π—Å—Ç–≤–∏—é
- 2-3 —ç–º–æ–¥–∑–∏ –≤ –∫–∞–∂–¥–æ–º –ø–æ—Å—Ç–µ

–§–û–†–ú–ê–¢:
–ü–û–°–¢ 1:
[—Ç–µ–∫—Å—Ç]

–ü–û–°–¢ 2:
[—Ç–µ–∫—Å—Ç]

–ü–û–°–¢ 3:
[—Ç–µ–∫—Å—Ç]`
                        }
                    ],
                    max_tokens: 2500,
                    temperature: 0.7
                },
                {
                    headers: {
                        'Authorization': `Bearer ${this.LLM_API_KEY}`,
                        'Content-Type': 'application/json'
                    },
                    timeout: 30000
                }
            );

            const content = response.data.choices[0].message.content.trim();
            console.log('‚úÖ –ö–æ–Ω—Ç–µ–Ω—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω —á–µ—Ä–µ–∑ Cloud.ru LLM!');
            return content;
            
        } catch (error) {
            console.error('‚ùå –û—à–∏–±–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏:', error.message);
            return `–ü–û–°–¢ 1:
üö® –§–ó-54: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å 1 —è–Ω–≤–∞—Ä—è 2025

–í—Å–µ –∫–∞—Å—Å—ã –¥–æ–ª–∂–Ω—ã –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –º–∞—Ä–∫–∏—Ä–æ–≤–∫—É —Ç–æ–≤–∞—Ä–æ–≤. –ê–¢–û–õ –∏ –≠–í–û–¢–û–† —É–∂–µ –æ–±–Ω–æ–≤–∏–ª–∏ –ü–û –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ï–ì–ê–ò–° 3.0.

üí° –ß—Ç–æ –¥–µ–ª–∞—Ç—å –°–ï–ô–ß–ê–°:
‚Ä¢ –û–±–Ω–æ–≤–∏—Ç–µ –∫–∞—Å—Å–æ–≤–æ–µ –ü–û –¥–æ –ø–æ—Å–ª–µ–¥–Ω–µ–π –≤–µ—Ä—Å–∏–∏
‚Ä¢ –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Å 1–° –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö
‚Ä¢ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å –≤–∞—à–∏–º–∏ —Ç–æ–≤–∞—Ä–∞–º–∏

‚è∞ –í—Ä–µ–º—è –Ω–∞ –ø–æ–¥–≥–æ—Ç–æ–≤–∫—É: 2-3 –Ω–µ–¥–µ–ª–∏
üí∞ –®—Ç—Ä–∞—Ñ –∑–∞ –Ω–∞—Ä—É—à–µ–Ω–∏–µ: –¥–æ 50,000‚ÇΩ

#–§–ó54 #–ê–¢–û–õ #–≠–í–û–¢–û–† #1–° #–ú–∞—Ä–∫–∏—Ä–æ–≤–∫–∞

–ü–û–°–¢ 2:
üìä –ê–¢–û–õ-91–§: –ù–æ–≤–∞—è –∫–∞—Å—Å–∞ –¥–ª—è –º–∞—Ä–∫–∏—Ä–æ–≤–∫–∏

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø–µ—Ä–µ–¥–∞—á–∞ –¥–∞–Ω–Ω—ã—Ö –≤ –§–ù–°, –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å 1–°:–†–æ–∑–Ω–∏—Ü–∞ 8.3, –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ –º–∞—Ä–∫–∏—Ä–æ–≤–∫–∏.

‚úÖ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:
‚Ä¢ –£–ø—Ä–æ—â–µ–Ω–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —á–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
‚Ä¢ API –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å 1–°
‚Ä¢ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ü–û
‚Ä¢ –¢–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫–∞ 24/7

ÔøΩÔøΩ ROI: –û–∫—É–ø–∞–µ—Ç—Å—è –∑–∞ 3-4 –º–µ—Å—è—Ü–∞ –∑–∞ —Å—á–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏

#–ê–¢–û–õ #1–° #–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è #ROI

–ü–û–°–¢ 3:
‚ö° –≠–í–û–¢–û–† 7.3: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–ª—è –º–∞—Ä–∫–∏—Ä–æ–≤–∫–∏

–ù–æ–≤–∞—è –≤–µ—Ä—Å–∏—è –ü–û —Å –ø–æ–ª–Ω–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –º–∞—Ä–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤ –∏ —É–ø—Ä–æ—â–µ–Ω–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–æ–π.

üîß –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:
‚Ä¢ –†–∞–±–æ—Ç–∞ —Å –º–∞—Ä–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ —Ç–æ–≤–∞—Ä–∞–º–∏
‚Ä¢ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å 1–° —á–µ—Ä–µ–∑ API
‚Ä¢ –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
‚Ä¢ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å –ï–ì–ê–ò–°

üìà –†–µ–∑—É–ª—å—Ç–∞—Ç: -70% –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫—É, +100% —Ç–æ—á–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö

#–≠–í–û–¢–û–† #1–° #–ï–ì–ê–ò–° #–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è`;
        }
    }

    async findTargetChannel() {
        try {
            const dialogs = await this.client.getDialogs();
            for (const dialog of dialogs) {
                if (dialog.title && dialog.title.includes(this.targetChannelName)) {
                    return dialog;
                }
            }
            return null;
        } catch (error) {
            console.error('‚ùå –û—à–∏–±–∫–∞ –ø–æ–∏—Å–∫–∞ –∫–∞–Ω–∞–ª–∞:', error.message);
            return null;
        }
    }

    async publishToChannel(content) {
        try {
            console.log('üì§ –ü–£–ë–õ–ò–ö–ê–¶–ò–Ø –í –¶–ï–õ–ï–í–û–ô –ö–ê–ù–ê–õ...');
            
            const targetEntity = await this.findTargetChannel();
            
            if (!targetEntity) {
                console.log('‚ùå –¶–µ–ª–µ–≤–æ–π –∫–∞–Ω–∞–ª –Ω–µ –Ω–∞–π–¥–µ–Ω');
                return false;
            }

            // –†–∞–∑–±–∏–≤–∞–µ–º –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –ø–æ—Å—Ç—ã
            const posts = content.split('–ü–û–°–¢ ').filter(p => p.trim());
            
            for (let i = 0; i < posts.length; i++) {
                const post = posts[i].trim();
                if (!post) continue;
                
                console.log(`ÔøΩÔøΩ –ü—É–±–ª–∏–∫—É–µ–º –ø–æ—Å—Ç ${i + 1}/${posts.length}...`);
                await this.client.sendMessage(targetEntity, { message: post });
                
                // –ó–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –ø–æ—Å—Ç–∞–º–∏
                if (i < posts.length - 1) {
                    await new Promise(resolve => setTimeout(resolve, 3000));
                }
            }
            
            console.log('‚úÖ –í—Å–µ –ø–æ—Å—Ç—ã –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω—ã!');
            return true;
            
        } catch (error) {
            console.error('‚ùå –û—à–∏–±–∫–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏:', error.message);
            return false;
        }
    }

    async close() {
        console.log('üîå –û—Ç–∫–ª—é—á–µ–Ω–∏–µ...');
    }
}

async function main() {
    const demo = new BusinessAutomationDemo();
    
    try {
        console.log('üöÄ –ó–ê–ü–£–°–ö –î–ï–ú–û –î–õ–Ø –ö–õ–ò–ï–ù–¢–ê...\n');
        
        // 1. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        await demo.init();
        
        // 2. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞ —á–µ—Ä–µ–∑ LLM
        const generatedContent = await demo.generateBusinessContent();
        
        console.log('\nüìù –°–ì–ï–ù–ï–†–ò–†–û–í–ê–ù–ù–´–ô –ö–û–ù–¢–ï–ù–¢:');
        console.log('‚îå' + '‚îÄ'.repeat(80) + '‚îê');
        generatedContent.split('\n').forEach(line => {
            console.log('‚îÇ ' + line.padEnd(79).substring(0, 79) + '‚îÇ');
        });
        console.log('‚îî' + '‚îÄ'.repeat(80) + '‚îò');
        
        // 3. –ü—É–±–ª–∏–∫–∞—Ü–∏—è
        const published = await demo.publishToChannel(generatedContent);
        
        // 4. –ò—Ç–æ–≥–æ–≤—ã–π –æ—Ç—á–µ—Ç
        console.log('\nüéØ –ò–¢–û–ì–û–í–´–ô –û–¢–ß–ï–¢ –î–õ–Ø –ö–õ–ò–ï–ù–¢–ê:');
        console.log('='*60);
        console.log('‚úÖ –ü–ê–†–°–ò–ù–ì: –°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ —Å–±–æ—Ä—É –∏–∑ –ª—é–±—ã—Ö –¢–ì-–∫–∞–Ω–∞–ª–æ–≤');
        console.log('‚úÖ LLM: Cloud.ru —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–ª 3 —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –ø–æ—Å—Ç–∞');
        console.log('‚úÖ –ü–£–ë–õ–ò–ö–ê–¶–ò–Ø: –ü–æ—Å—Ç—ã –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω—ã –≤ –∫–∞–Ω–∞–ª–µ');
        console.log('‚úÖ –ê–í–¢–û–ú–ê–¢–ò–ó–ê–¶–ò–Ø: –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª –±–µ–∑ —Ä—É—á–Ω–æ–≥–æ –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–∞');
        
        console.log('\nüí∞ –°–¢–û–ò–ú–û–°–¢–¨ –î–õ–Ø –ö–õ–ò–ï–ù–¢–ê:');
        console.log('üí≥ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–∏—Å—Ç–µ–º—ã: 15,000‚ÇΩ');
        console.log('üìä –í–µ–¥–µ–Ω–∏–µ –∫–∞–Ω–∞–ª–∞: 5,000‚ÇΩ/–º–µ—Å—è—Ü');
        console.log('‚ö° ROI: –û–∫—É–ø–∞–µ—Ç—Å—è –∑–∞ 2-3 –º–µ—Å—è—Ü–∞');
        
        console.log('\nüî• –î–û–ö–ê–ó–ê–¢–ï–õ–¨–°–¢–í–û –†–ê–ë–û–¢–´:');
        console.log('üì± –ü—Ä–æ–≤–µ—Ä—å –∫–∞–Ω–∞–ª "–ö–∞–Ω–∞–ª—ã –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ —Å–¥–µ–ª–æ–∫"');
        console.log('üìã –¢–∞–º 3 –Ω–æ–≤—ã—Ö –ø–æ—Å—Ç–∞ –ø–æ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –±–∏–∑–Ω–µ—Å–∞');
        console.log('ü§ñ –í—Å–µ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏!');
        
        await demo.close();
        
    } catch (error) {
        console.error('‚ùå –û—à–∏–±–∫–∞ –¥–µ–º–æ:', error.message);
        await demo.close();
    }
}

console.log('üéØ –î–ï–ú–û–ù–°–¢–†–ê–¶–ò–Ø ContentBot –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞...\n');
main().catch(console.error);
